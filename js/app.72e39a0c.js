(function(){var t={654:function(t,e,n){"use strict";var a=n(6848),o=n(9143),i=n.n(o),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.isLoggedIn?e("div",[e("div",{staticClass:"upload-container"},[e("div",{staticClass:"upload-wrapper"},[e("label",{staticClass:"upload-button"},[e("span",{staticClass:"upload-icon"},[t._v("üìÑ")]),e("span",{staticClass:"upload-text"},[t._v("ÈÄâÊã©PDFÊñá‰ª∂")]),e("input",{attrs:{type:"file",accept:"application/pdf"},on:{change:t.handleFileUpload}})]),e("div",{staticClass:"action-buttons"},[e("button",{staticClass:"export-button",on:{click:t.exportToXLSX}},[e("span",{staticClass:"icon"},[t._v("üì§")]),t._v(" ÂØºÂá∫XLSX ")]),e("button",{staticClass:"batch-edit-button",on:{click:function(e){t.showBatchEditModal=!0}}},[e("span",{staticClass:"icon"},[t._v("‚úèÔ∏è")]),t._v(" ÊâπÈáèÁºñËæë ")])]),e("div",{staticClass:"conversion-system"},[e("h3",[t._v("PDFÈ¢òÂú®Á∫øËΩ¨Êç¢Á≥ªÁªü")]),e("div",{staticClass:"system-info"},[e("p",[t._v(" Êñá‰ª∂Ôºö"),e("span",{staticClass:"status"},[t._v(t._s(t.fileName))])])]),t._m(0)])])]),t.parsedData.length?e("div",{staticClass:"table-container"},[e("el-table",{staticStyle:{width:"100%"},attrs:{height:"650",data:t.parsedData}},[e("el-table-column",{attrs:{prop:"course",label:"ËØæÁ®ã",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return[e("el-input",{model:{value:n.course,callback:function(e){t.$set(n,"course",e)},expression:"row.course"}})]}}],null,!1,2592193046)}),e("el-table-column",{attrs:{prop:"unit",label:"ÂçïÂÖÉ",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return[e("el-input",{model:{value:n.unit,callback:function(e){t.$set(n,"unit",e)},expression:"row.unit"}})]}}],null,!1,1529771917)}),e("el-table-column",{attrs:{prop:"type",label:"È¢òÁõÆÁ±ªÂûã",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"content",label:"È¢òÁõÆÂÜÖÂÆπ",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"answer",label:"Ê≠£Á°ÆÁ≠îÊ°à",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"analysis",label:"Ëß£Êûê",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"image",label:"ÈÖçÂõæ",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option1",label:"ÈÄâÈ°π1",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option2",label:"ÈÄâÈ°π2",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option3",label:"ÈÄâÈ°π3",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option4",label:"ÈÄâÈ°π4",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option5",label:"ÈÄâÈ°π5",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option6",label:"ÈÄâÈ°π6",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option7",label:"ÈÄâÈ°π7",width:"200",align:"center"}}),e("el-table-column",{attrs:{prop:"option8",label:"ÈÄâÈ°π8",width:"200",align:"center"}})],1)],1):t._e(),t.showBatchEditModal?e("div",{staticClass:"modal-overlay"},[e("div",{staticClass:"modal-content"},[e("h3",[t._v("ÊâπÈáèÁºñËæë")]),e("div",{staticClass:"form-group"},[e("label",[t._v("ËØæÁ®ãÔºö")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchCourse,expression:"batchCourse"}],staticClass:"form-input",domProps:{value:t.batchCourse},on:{input:function(e){e.target.composing||(t.batchCourse=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("ÂçïÂÖÉÔºö")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchUnit,expression:"batchUnit"}],staticClass:"form-input",domProps:{value:t.batchUnit},on:{input:function(e){e.target.composing||(t.batchUnit=e.target.value)}}})]),e("div",{staticClass:"modal-actions"},[e("button",{staticClass:"confirm-button",on:{click:t.applyBatchEdit}},[t._v("Á°ÆËÆ§")]),e("button",{staticClass:"cancel-button",on:{click:function(e){t.showBatchEditModal=!1}}},[t._v(" ÂèñÊ∂à ")])])])]):t._e(),t.isUploading?e("div",{staticClass:"uploading-overlay"},[e("div",{staticClass:"uploading-spinner"}),e("div",{staticClass:"uploading-text"},[t._v("Ê≠£Âú®‰∏ä‰º†Âπ∂Ëß£ÊûêPDFÊñá‰ª∂ÔºåËØ∑Á®çÂÄô...")])]):t._e()]):e("div",{staticClass:"login-container"},[e("div",{staticClass:"login-box"},[e("h2",[t._v("PDFÈ¢òÂú®Á∫øËΩ¨Êç¢Á≥ªÁªü")]),e("div",{staticClass:"form-group"},[e("label",[t._v("Áî®Êà∑ÂêçÔºö")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-input",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",[t._v("ÂØÜÁ†ÅÔºö")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-input",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("button",{staticClass:"login-button",on:{click:t.handleLogin}},[t._v("ÁôªÂΩï")])])])])},l=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"system-info"},[e("p",[t._v("ÂΩìÂâçÁä∂ÊÄÅÔºö"),e("span",{staticClass:"status"},[t._v("ËøêË°å‰∏≠")])])])}],r=(n(4114),n(8111),n(2489),n(116),n(7588),n(1701),n(5279)),c=n(6726),p=n.n(c),u=n(3230),d={name:"App",data(){return{parsedData:[],showBatchEditModal:!1,batchCourse:"",batchUnit:"",isUploading:!1,isLoggedIn:!0,username:"PDFÈ¢òÂú®Á∫øËΩ¨Êç¢Á≥ªÁªü",password:"123456",fileName:""}},mounted(){},methods:{handleLogin(){"PDFÈ¢òÂú®Á∫øËΩ¨Êç¢Á≥ªÁªü"===this.username&&"123456"===this.password?this.isLoggedIn=!0:alert("Áî®Êà∑ÂêçÊàñÂØÜÁ†ÅÈîôËØØ")},async handleFileUpload(t){this.isUploading=!0;const e=t.target.files[0];this.fileName=e?e.name:"Êú™ÈÄâÊã©Êñá‰ª∂",setTimeout((async()=>{this.isUploading=!1;const e=t.target.files[0];if(e){const t=await e.arrayBuffer();r.GlobalWorkerOptions.workerSrc=p();try{const e=r.getDocument({data:t,disableAutoFetch:!0,disableStream:!0}),n=await e.promise,a=n.numPages;let o="";for(let t=1;t<=a;t++){const e=await n.getPage(t),a=await e.getTextContent();o+=a.items.map((t=>t.str)).join("\n")+"\n"}const i=o.replace(/ÁæøËøáÊïôËÇ≤ÂÆòÁΩë www\.yiguojy\.com ÁâàÊùÉÊâÄÊúâ/g,"").replace(/‰∏ì‰∏öÁΩëÊ†°ËØæÁ®ã„ÄÅÈ¢òÂ∫ìËΩØ‰ª∂„ÄÅËÄÉËØïÁî®‰π¶„ÄÅËµÑËÆØ‰ø°ÊÅØÂÖ®Êñπ‰Ωç‰∏Ä‰ΩìÂåñËÅå‰∏öËÄÉËØïÂ≠¶‰π†Âπ≥Âè∞/g,""),s=i.split(/(?=\d+\.)/g),l=[];s.forEach((t=>{const e=t.split("\n").filter((t=>t.trim()));if(e.length>=3){const t=e.slice(1,-2).filter((t=>!t.startsWith("ÂèÇËÄÉÁ≠îÊ°à")&&!t.startsWith("„Äê"))).map((t=>t.trim())),a=e.findIndex((t=>t.startsWith("„ÄêÁæøËøáËß£Êûê„Äë")));console.log(a,"Ëß£ÊûêÂïä");var n=e.slice(a).join("\n").split("„ÄêÁæøËøáËß£Êûê„Äë")[1];/\d$/.test(n)&&(n=n.slice(0,-1)),n&&n.endsWith("ÈóÆÁ≠îÈ¢ò")&&(n=n.slice(0,-3));const o={A:"option1",B:"option2",C:"option3",D:"option4",E:"option5",F:"option6",G:"option7",H:"option8"},i={};t.forEach((t=>{const e=t.match(/^([A-H])\.\s*(.*)/);if(e){const[,t,n]=e;i[o[t]]=n}}));const s=e.find((t=>t.startsWith("ÂèÇËÄÉÁ≠îÊ°àÔºö"))),r=s?s.split("ÂèÇËÄÉÁ≠îÊ°àÔºö")[1]:"";let c="";for(let n=0;n<e.length;n++){const t=e[n];if(t.startsWith("A.")){c=e.slice(0,n).join("").replace(/^\d+\./,"");break}if(t.endsWith("„ÄÇ")||t.endsWith("Ôºâ")||t.endsWith("ÈóÆÔºö")||t.endsWith("Ôºü")||/^\(\d+\)/.test(t)){if(c+=t.replace(/^\d+\./,""),t.endsWith("„ÄÇ")||t.endsWith("Ôºâ")||t.endsWith("ÈóÆÔºö")||t.endsWith("Ôºü"))break}else c+=t.replace(/^\d+\./,"")}l.push({course:"‰∏ìÂçáÊú¨-Ê≥ïÂ≠¶Á±ª",unit:"Ê∞ëÊ≥ï",type:"ÂçïÈÄâÈ¢ò",content:c,answer:r,analysis:n,image:"",option1:1,option2:2,option3:3,option4:4,option5:5,option6:6,option7:7,option8:8})}})),this.parsedData=l}catch(n){console.error("PDFËß£ÊûêÂ§±Ë¥•:",n)}}}),1500)},exportToXLSX(){if(0===this.parsedData.length)return void alert("Ê≤°ÊúâÊï∞ÊçÆÂèØ‰ª•ÂØºÂá∫ÔºÅ");const t={course:"ËØæÁ®ã",unit:"ÂçïÂÖÉ",type:"È¢òÁõÆÁ±ªÂûã",content:"È¢òÁõÆÂÜÖÂÆπ",answer:"Ê≠£Á°ÆÁ≠îÊ°à",analysis:"Ëß£Êûê",image:"ÈÖçÂõæ",option1:"ÈÄâÈ°π1",option2:"ÈÄâÈ°π2",option3:"ÈÄâÈ°π3",option4:"ÈÄâÈ°π4",option5:"ÈÄâÈ°π5",option6:"ÈÄâÈ°π6",option7:"ÈÄâÈ°π7",option8:"ÈÄâÈ°π8"},e=this.parsedData.map((e=>{const n={};for(const a in e)n[t[a]]=e[a];return n})),n=u.Wp.json_to_sheet(e),a=u.Wp.book_new();u.Wp.book_append_sheet(a,n,"Sheet1");const o=this.fileName?this.fileName.replace(".pdf",".xlsx"):"export.xlsx";u._h(a,o)},applyBatchEdit(){this.parsedData.forEach((t=>{this.batchCourse&&(t.course=this.batchCourse),this.batchUnit&&(t.unit=this.batchUnit)})),this.showBatchEditModal=!1}}},h=d,f=n(1656),m=(0,f.A)(h,s,l,!1,null,null,null),v=m.exports;a["default"].use(i()),new a["default"]({el:"#app",render:t=>t(v)})},1815:function(){},3237:function(){},5168:function(){},6671:function(){},7492:function(){},7640:function(){}},e={};function n(a){var o=e[a];if(void 0!==o)return o.exports;var i=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,a,o,i){if(!a){var s=1/0;for(p=0;p<t.length;p++){a=t[p][0],o=t[p][1],i=t[p][2];for(var l=!0,r=0;r<a.length;r++)(!1&i||s>=i)&&Object.keys(n.O).every((function(t){return n.O[t](a[r])}))?a.splice(r--,1):(l=!1,i<s&&(s=i));if(l){t.splice(p--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[a,o,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var o,i,s=a[0],l=a[1],r=a[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(r)var p=r(n)}for(e&&e(a);c<s.length;c++)i=s[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(p)},a=self["webpackChunkniuzi"]=self["webpackChunkniuzi"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(654)}));a=n.O(a)})();
//# sourceMappingURL=app.72e39a0c.js.map